# Oracle Cloud Infrastructure Terraform Module for Full Stack Disaster Recovery 

*This module is for creating resources related to [Full Stack Disaster Recovery](https://www.oracle.com/cloud/full-stack-disaster-recovery/) in Oracle Cloud Infrastructure*

Note: the root folder of this module contains no Terraform code: it groups together the related submodules.

The file and directory layout follows the Terraform Standard Module Structure:

modules folder contains several standalone, reusable, submodules for creating IAM resources in Oracle Cloud Infrastructure,
examples folder contains fully-functional examples that you can copy and paste "as is" to have a first look at the submodules capabilities.

## Pre-requisites:

- git is installed. 
- Terraform 1.3.0 or higher version is installed.

## Usage

See the [examples/](./examples/fsdr/) folder for usage examples.

```hcl
module "fsdr" {
  source = "../../"
  providers = {
    oci.region1 = oci.region1
    oci.region2 = oci.region2
  }
  region1_config = yamldecode(file("${path.module}/region1.yaml"))
  region2_config = yamldecode(file("${path.module}/region2.yaml"))
}
```
| Name | Version |
|------|---------|
| <a name="requirement_terraform"></a> [terraform](#requirement\_terraform) | >= 1.3.0 |
| <a name="requirement_oci"></a> [oci](#requirement\_oci) | >= 5.0.0 |

## Providers

| Name | Version |
|------|---------|
| <a name="provider_oci.region1"></a> [oci.region1](#provider\_oci.region1) | >= 5.0.0 |
| <a name="provider_oci.region2"></a> [oci.region2](#provider\_oci.region2) | >= 5.0.0 |

## Modules

| Name | Source | Version |
|------|--------|---------|
| <a name="module_dr_plan_execution_region1"></a> [dr\_plan\_execution\_region1](#module\_dr\_plan\_execution\_region1) | ./modules/dr-plan-and-execution | n/a |
| <a name="module_dr_plan_execution_region2"></a> [dr\_plan\_execution\_region2](#module\_dr\_plan\_execution\_region2) | ./modules/dr-plan-and-execution | n/a |
| <a name="module_dr_plan_region1"></a> [dr\_plan\_region1](#module\_dr\_plan\_region1) | ./modules/dr-plan-and-execution | n/a |
| <a name="module_dr_plan_region2"></a> [dr\_plan\_region2](#module\_dr\_plan\_region2) | ./modules/dr-plan-and-execution | n/a |
| <a name="module_dr_protection_group_region1"></a> [dr\_protection\_group\_region1](#module\_dr\_protection\_group\_region1) | ./modules/dr-protection-group | n/a |
| <a name="module_dr_protection_group_region2"></a> [dr\_protection\_group\_region2](#module\_dr\_protection\_group\_region2) | ./modules/dr-protection-group | n/a |

## Resources

| Name | Type |
|------|------|
| [oci_disaster_recovery_dr_protection_group.region1_dr_protection_group](https://registry.terraform.io/providers/oracle/oci/latest/docs/data-sources/disaster_recovery_dr_protection_group) | data source |
| [oci_disaster_recovery_dr_protection_group.region2_dr_protection_group](https://registry.terraform.io/providers/oracle/oci/latest/docs/data-sources/disaster_recovery_dr_protection_group) | data source |
| [oci_disaster_recovery_dr_protection_groups.region1_dr_protection_groups](https://registry.terraform.io/providers/oracle/oci/latest/docs/data-sources/disaster_recovery_dr_protection_groups) | data source |
| [oci_disaster_recovery_dr_protection_groups.region2_dr_protection_groups](https://registry.terraform.io/providers/oracle/oci/latest/docs/data-sources/disaster_recovery_dr_protection_groups) | data source |

## Inputs

| Name | Description | Type | Default | Required |
|------|-------------|------|---------|:--------:|
| <a name="input_region1_config"></a> [region1\_config](#input\_region1\_config) | Region1 config is required. This is PRIMARY. | <pre>object({<br/>    compartment_id                = string<br/>    protection_group_display_name = string<br/>    peer_region                   = string<br/>    defined_tags                  = optional(map(string), null)<br/>    freeform_tags                 = optional(map(string), null)<br/>    log_location = object({<br/>      bucket    = string<br/>      namespace = string<br/>    })<br/>    disassociate_trigger = optional(number, null)<br/>    add_members = optional(list(object({<br/>      autonomous_database_standby_type_for_dr_drills = optional(string, null)<br/>      member_id                                      = string<br/>      member_type                                    = string<br/>      bucket                                         = optional(string, null)<br/>      connection_string_type                         = optional(string, null)<br/>      destination_availability_domain                = optional(string, null)<br/>      destination_backup_policy_id                   = optional(string, null)<br/>      destination_capacity_reservation_id            = optional(string, null)<br/>      destination_compartment_id                     = optional(string, null)<br/>      destination_dedicated_vm_host_id               = optional(string, null)<br/>      destination_load_balancer_id                   = optional(string, null)<br/>      destination_network_load_balancer_id           = optional(string, null)<br/>      destination_snapshot_policy_id                 = optional(string, null)<br/>      gtid_reconciliation_timeout                    = optional(number, 0)<br/>      is_continue_on_gtid_reconciliation_timeout     = optional(bool, false)<br/>      is_movable                                     = optional(bool, false)<br/>      is_retain_fault_domain                         = optional(bool, false)<br/>      is_start_stop_enabled                          = optional(bool, false)<br/>      jump_host_id                                   = optional(string, null)<br/>      namespace                                      = optional(string, null)<br/>      password_vault_secret_id                       = optional(string, null)<br/>      peer_cluster_id                                = optional(string, null)<br/>      peer_db_system_id                              = optional(string, null)<br/>      backend_set_mappings = optional(list(object({<br/>        destination_backend_set_name   = optional(string, null)<br/>        is_backend_set_for_non_movable = optional(bool, false)<br/>        source_backend_set_name        = optional(string, null)<br/>      })), [])<br/>      backup_config = optional(object({<br/>        backup_schedule                   = optional(string, null)<br/>        exclude_namespaces                = optional(list(string), [])<br/>        image_replication_vault_secret_id = optional(string, null)<br/>        max_number_of_backups_retained    = optional(number, null)<br/>        namespaces                        = optional(list(string), [])<br/>        replicate_images                  = optional(string, null)<br/>      }), null)<br/>      backup_location = optional(object({<br/>        bucket    = optional(string, null)<br/>        namespace = optional(string, null)<br/>      }), null)<br/>      block_volume_attach_and_mount_operations = optional(object({<br/>        attachments = optional(list(object({<br/>          block_volume_id                         = optional(string, null)<br/>          volume_attachment_reference_instance_id = optional(string, null)<br/>        })), [])<br/>        mounts = optional(list(object({<br/>          mount_point = optional(string, null)<br/>        })), [])<br/>      }), {})<br/>      common_destination_key = optional(object({<br/>        encryption_key_id = optional(string, null)<br/>        vault_id          = optional(string, null)<br/>      }), null)<br/>      db_system_admin_user_details = optional(object({<br/>        password_vault_secret_id = optional(string, null)<br/>        username                 = optional(string, null)<br/>      }), null)<br/>      db_system_replication_user_details = optional(object({<br/>        password_vault_secret_id = optional(string, null)<br/>        username                 = optional(string, null)<br/>      }), null)<br/>      destination_encryption_key = optional(object({<br/>        encryption_key_id = optional(string, null)<br/>        vault_id          = optional(string, null)<br/>      }), null)<br/>      export_mappings = optional(list(object({<br/>        destination_mount_target_id = optional(string, null)<br/>        export_id                   = optional(string, null)<br/>      })), [])<br/>      file_system_operations = optional(list(object({<br/>        export_path = optional(string, null)<br/>        mount_details = optional(object({<br/>          mount_target_id = optional(string, null)<br/>        }), null)<br/>        unmount_details = optional(object({<br/>          unmount_target_id = optional(string, null)<br/>        }), null)<br/>        mount_point     = optional(string, null)<br/>        mount_target_id = optional(string, null)<br/>      })), [])<br/>      load_balancer_mappings = optional(list(object({<br/>        destination_load_balancer_id = optional(string, null)<br/>        source_load_balancer_id      = optional(string, null)<br/>      })), [])<br/>      managed_node_pool_configs = optional(list(object({<br/>        id      = optional(string, null)<br/>        maximum = optional(number, null)<br/>        minimum = optional(number, null)<br/>      })), [])<br/>      network_load_balancer_mappings = optional(list(object({<br/>        destination_network_load_balancer_id = optional(string, null)<br/>        source_network_load_balancer_id      = optional(string, null)<br/>      })), [])<br/>      source_volume_to_destination_encryption_key_mappings = optional(list(object({<br/>        source_volume_id = optional(string, null)<br/>        destination_encryption_key = optional(object({<br/>          encryption_key_id = optional(string, null)<br/>          vault_id          = optional(string, null)<br/>        }), null)<br/>      })), [])<br/>      vault_mappings = optional(list(object({<br/>        destination_vault_id = optional(string, null)<br/>        source_vault_id      = optional(string, null)<br/>      })), [])<br/>      virtual_node_pool_configs = optional(list(object({<br/>        id      = optional(string, null)<br/>        maximum = optional(number, null)<br/>        minimum = optional(number, null)<br/>      })), [])<br/>      vnic_mapping = optional(list(object({<br/>        destination_nsg_id_list = optional(list(string), [])<br/>        destination_subnet_id   = optional(string, null)<br/>        source_vnic_id          = optional(string, null)<br/>      })), [])<br/>      vnic_mappings = optional(list(object({<br/>        destination_nsg_id_list                       = optional(list(string), [])<br/>        destination_primary_private_ip_address        = optional(string, null)<br/>        destination_primary_private_ip_hostname_label = optional(string, null)<br/>        destination_reserved_public_ip_id             = optional(string, null)<br/>        destination_subnet_id                         = optional(string, null)<br/>        source_vnic_id                                = optional(string, null)<br/>      })), [])<br/>    })), [])<br/><br/>    remove_members = optional(list(string), [])<br/>    dr_plan_and_execution = optional(list(object({<br/>      plan_display_name = string<br/>      type              = string<br/>      defined_tags      = optional(map(string), null)<br/>      freeform_tags     = optional(map(string), null)<br/>      source_plan_id    = optional(string, null)<br/>      refresh_trigger   = optional(number, null)<br/>      verify_trigger    = optional(number, null)<br/>      plan_execution = optional(list(object({<br/>        plan_execution_type    = string<br/>        are_prechecks_enabled  = optional(bool, false)<br/>        are_warnings_ignored   = optional(bool, false)<br/>        defined_tags           = optional(map(string), null)<br/>        execution_display_name = string<br/>        freeform_tags          = optional(map(string), null)<br/>        timeouts_create        = optional(string, "20m")<br/>        timeouts_update        = optional(string, "20m")<br/>      })), [])<br/>    })), [])<br/>  })</pre> | n/a | yes |
| <a name="input_region2_config"></a> [region2\_config](#input\_region2\_config) | Region2 config is required. This is STANDBY. | <pre>object({<br/>    compartment_id                = string<br/>    protection_group_display_name = string<br/>    defined_tags                  = optional(map(string), null)<br/>    freeform_tags                 = optional(map(string), null)<br/>    log_location = object({<br/>      bucket    = string<br/>      namespace = string<br/>    })<br/>    disassociate_trigger = optional(number, null)<br/>    add_members = optional(list(object({<br/>      autonomous_database_standby_type_for_dr_drills = optional(string, null)<br/>      member_id                                      = string<br/>      member_type                                    = string<br/>      bucket                                         = optional(string, null)<br/>      connection_string_type                         = optional(string, null)<br/>      destination_availability_domain                = optional(string, null)<br/>      destination_backup_policy_id                   = optional(string, null)<br/>      destination_capacity_reservation_id            = optional(string, null)<br/>      destination_compartment_id                     = optional(string, null)<br/>      destination_dedicated_vm_host_id               = optional(string, null)<br/>      destination_load_balancer_id                   = optional(string, null)<br/>      destination_network_load_balancer_id           = optional(string, null)<br/>      destination_snapshot_policy_id                 = optional(string, null)<br/>      gtid_reconciliation_timeout                    = optional(number, 0)<br/>      is_continue_on_gtid_reconciliation_timeout     = optional(bool, false)<br/>      is_movable                                     = optional(bool, false)<br/>      is_retain_fault_domain                         = optional(bool, false)<br/>      is_start_stop_enabled                          = optional(bool, false)<br/>      jump_host_id                                   = optional(string, null)<br/>      namespace                                      = optional(string, null)<br/>      password_vault_secret_id                       = optional(string, null)<br/>      peer_cluster_id                                = optional(string, null)<br/>      peer_db_system_id                              = optional(string, null)<br/>      backend_set_mappings = optional(list(object({<br/>        destination_backend_set_name   = optional(string, null)<br/>        is_backend_set_for_non_movable = optional(bool, false)<br/>        source_backend_set_name        = optional(string, null)<br/>      })), [])<br/>      backup_config = optional(object({<br/>        backup_schedule                   = optional(string, null)<br/>        exclude_namespaces                = optional(list(string), [])<br/>        image_replication_vault_secret_id = optional(string, null)<br/>        max_number_of_backups_retained    = optional(number, null)<br/>        namespaces                        = optional(list(string), [])<br/>        replicate_images                  = optional(string, null)<br/>      }), null)<br/>      backup_location = optional(object({<br/>        bucket    = optional(string, null)<br/>        namespace = optional(string, null)<br/>      }), null)<br/>      block_volume_attach_and_mount_operations = optional(object({<br/>        attachments = optional(list(object({<br/>          block_volume_id                         = optional(string, null)<br/>          volume_attachment_reference_instance_id = optional(string, null)<br/>        })), [])<br/>        mounts = optional(list(object({<br/>          mount_point = optional(string, null)<br/>        })), [])<br/>      }), {})<br/>      common_destination_key = optional(object({<br/>        encryption_key_id = optional(string, null)<br/>        vault_id          = optional(string, null)<br/>      }), null)<br/>      db_system_admin_user_details = optional(object({<br/>        password_vault_secret_id = optional(string, null)<br/>        username                 = optional(string, null)<br/>      }), null)<br/>      db_system_replication_user_details = optional(object({<br/>        password_vault_secret_id = optional(string, null)<br/>        username                 = optional(string, null)<br/>      }), null)<br/>      destination_encryption_key = optional(object({<br/>        encryption_key_id = optional(string, null)<br/>        vault_id          = optional(string, null)<br/>      }), null)<br/>      export_mappings = optional(list(object({<br/>        destination_mount_target_id = optional(string, null)<br/>        export_id                   = optional(string, null)<br/>      })), [])<br/>      file_system_operations = optional(list(object({<br/>        export_path = optional(string, null)<br/>        mount_details = optional(object({<br/>          mount_target_id = optional(string, null)<br/>        }), null)<br/>        unmount_details = optional(object({<br/>          unmount_target_id = optional(string, null)<br/>        }), null)<br/>        mount_point     = optional(string, null)<br/>        mount_target_id = optional(string, null)<br/>      })), [])<br/>      load_balancer_mappings = optional(list(object({<br/>        destination_load_balancer_id = optional(string, null)<br/>        source_load_balancer_id      = optional(string, null)<br/>      })), [])<br/>      managed_node_pool_configs = optional(list(object({<br/>        id      = optional(string, null)<br/>        maximum = optional(number, null)<br/>        minimum = optional(number, null)<br/>      })), [])<br/>      network_load_balancer_mappings = optional(list(object({<br/>        destination_network_load_balancer_id = optional(string, null)<br/>        source_network_load_balancer_id      = optional(string, null)<br/>      })), [])<br/>      source_volume_to_destination_encryption_key_mappings = optional(list(object({<br/>        source_volume_id = optional(string, null)<br/>        destination_encryption_key = optional(object({<br/>          encryption_key_id = optional(string, null)<br/>          vault_id          = optional(string, null)<br/>        }), null)<br/>      })), [])<br/>      vault_mappings = optional(list(object({<br/>        destination_vault_id = optional(string, null)<br/>        source_vault_id      = optional(string, null)<br/>      })), [])<br/>      virtual_node_pool_configs = optional(list(object({<br/>        id      = optional(string, null)<br/>        maximum = optional(number, null)<br/>        minimum = optional(number, null)<br/>      })), [])<br/>      vnic_mapping = optional(list(object({<br/>        destination_nsg_id_list = optional(list(string), [])<br/>        destination_subnet_id   = optional(string, null)<br/>        source_vnic_id          = optional(string, null)<br/>      })), [])<br/>      vnic_mappings = optional(list(object({<br/>        destination_nsg_id_list                       = optional(list(string), [])<br/>        destination_primary_private_ip_address        = optional(string, null)<br/>        destination_primary_private_ip_hostname_label = optional(string, null)<br/>        destination_reserved_public_ip_id             = optional(string, null)<br/>        destination_subnet_id                         = optional(string, null)<br/>        source_vnic_id                                = optional(string, null)<br/>      })), [])<br/>    })), [])<br/>    remove_members = optional(list(string), [])<br/>    dr_plan_and_execution = optional(list(object({<br/>      plan_display_name = string<br/>      type              = string<br/>      defined_tags      = optional(map(string), null)<br/>      freeform_tags     = optional(map(string), null)<br/>      source_plan_id    = optional(string, null)<br/>      refresh_trigger   = optional(number, null)<br/>      verify_trigger    = optional(number, null)<br/>      plan_execution = optional(list(object({<br/>        plan_execution_type    = string<br/>        are_prechecks_enabled  = optional(bool, false)<br/>        are_warnings_ignored   = optional(bool, false)<br/>        defined_tags           = optional(map(string), null)<br/>        execution_display_name = string<br/>        freeform_tags          = optional(map(string), null)<br/>        timeouts_create        = optional(string, "20m")<br/>        timeouts_update        = optional(string, "20m")<br/>      })), [])<br/>    })), [])<br/>  })</pre> | n/a | yes |

## Outputs

| Name | Description |
|------|-------------|
| <a name="output_region1_dr_protection_group_id"></a> [region1\_dr\_protection\_group\_id](#output\_region1\_dr\_protection\_group\_id) | Protection group OCID of region1 |
| <a name="output_region1_members"></a> [region1\_members](#output\_region1\_members) | Members of the existing protection group in region1 |
| <a name="output_region1_plan_ids"></a> [region1\_plan\_ids](#output\_region1\_plan\_ids) | OCID of region1 plans |
| <a name="output_region2_dr_protection_group_id"></a> [region2\_dr\_protection\_group\_id](#output\_region2\_dr\_protection\_group\_id) | Protection group OCID of region2 |
| <a name="output_region2_members"></a> [region2\_members](#output\_region2\_members) | Members of the existing protection group in region2 |
| <a name="output_region2_plan_ids"></a> [region2\_plan\_ids](#output\_region2\_plan\_ids) | OCID of region2 plans |



## Contributing

This project is open source. Oracle appreciates any contributions that are made by the open source community.

Learn how to [contribute](./CONTRIBUTING.md).

## Security

Please consult the [security guide](./SECURITY.md) for our responsible security vulnerability disclosure process

## License

Copyright (c) 2025, Oracle and/or its affiliates.

Licensed under the Universal Permissive License 1.0 or Apache License 2.0.

See [LICENSE](./LICENSE) for more details.## Requirements

